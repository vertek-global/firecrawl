{"version":3,"file":"generate-llmstxt-status.js","sourceRoot":"","sources":["../../../../src/controllers/v1/generate-llmstxt-status.ts"],"names":[],"mappings":";;AAKA,4EAmCC;AAtCD,8FAAmH;AAG5G,KAAK,UAAU,gCAAgC,CACpD,GAAiD,EACjD,GAAa;IAEb,MAAM,UAAU,GAAG,MAAM,IAAA,4CAAmB,EAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAC/D,MAAM,YAAY,GAAG,UAAU,EAAE,YAAY,IAAI,KAAK,CAAC;IAEvD,IAAI,CAAC,UAAU,EAAE,CAAC;QAChB,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YAC1B,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,kCAAkC;SAC1C,CAAC,CAAC;IACL,CAAC;IAED,IAAI,IAAI,GAAQ,IAAI,CAAC;IAErB,IAAI,YAAY,EAAE,CAAC;QACjB,IAAI,GAAG;YACL,OAAO,EAAE,UAAU,CAAC,aAAa;YACjC,WAAW,EAAE,UAAU,CAAC,QAAQ;SACjC,CAAC;IACJ,CAAC;SAAM,CAAC;QACN,IAAI,GAAG;YACL,OAAO,EAAE,UAAU,CAAC,aAAa;SAClC,CAAC;IACJ,CAAC;IAED,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;QAC1B,OAAO,EAAE,UAAU,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI;QAEtD,IAAI,EAAE,IAAI;QACV,MAAM,EAAE,UAAU,CAAC,MAAM;QACzB,KAAK,EAAE,UAAU,EAAE,KAAK,IAAI,SAAS;QACrC,SAAS,EAAE,CAAC,MAAM,IAAA,kDAAyB,EAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,WAAW,EAAE;KAC7E,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { Response } from \"express\";\nimport { RequestWithAuth } from \"./types\";\nimport { getGeneratedLlmsTxt, getGeneratedLlmsTxtExpiry } from \"../../lib/generate-llmstxt/generate-llmstxt-redis\";\nimport { supabaseGetJobsById } from \"../../lib/supabase-jobs\";\n\nexport async function generateLLMsTextStatusController(\n  req: RequestWithAuth<{ jobId: string }, any, any>,\n  res: Response,\n) {\n  const generation = await getGeneratedLlmsTxt(req.params.jobId);\n  const showFullText = generation?.showFullText ?? false;\n\n  if (!generation) {\n    return res.status(404).json({\n      success: false,\n      error: \"llmsTxt generation job not found\",\n    });\n  }\n\n  let data: any = null;\n\n  if (showFullText) {\n    data = {\n      llmstxt: generation.generatedText,\n      llmsfulltxt: generation.fullText,\n    };\n  } else {\n    data = {\n      llmstxt: generation.generatedText,\n    };\n  }\n\n  return res.status(200).json({\n    success: generation.status === \"failed\" ? false : true,\n    \n    data: data,\n    status: generation.status,\n    error: generation?.error ?? undefined,\n    expiresAt: (await getGeneratedLlmsTxtExpiry(req.params.jobId)).toISOString(),\n  });\n} "]}