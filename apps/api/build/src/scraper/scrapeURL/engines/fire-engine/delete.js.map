{"version":3,"file":"delete.js","sourceRoot":"","sources":["../../../../../../src/scraper/scrapeURL/engines/fire-engine/delete.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,4CAmCC;AAzCD,qDAAuC;AAEvC,2CAA8C;AAE9C,qCAAyC;AAElC,KAAK,UAAU,gBAAgB,CACpC,MAAc,EACd,KAAa,EACb,IAAsB,EACtB,KAAmB;IAEnB,MAAM,MAAM,CAAC,SAAS,CACpB;QACE,IAAI,EAAE,4BAA4B;QAClC,UAAU,EAAE;YACV,KAAK;SACN;KACF,EACD,KAAK,EAAE,IAAI,EAAE,EAAE;QACb,MAAM,IAAA,mBAAW,EAAC;YAChB,GAAG,EAAE,GAAG,sBAAa,WAAW,KAAK,EAAE;YACvC,MAAM,EAAE,QAAQ;YAChB,OAAO,EAAE;gBACP,GAAG,CAAC,MAAM,CAAC,aAAa,EAAE;oBACxB,CAAC,CAAC;wBACE,cAAc,EAAE,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC;wBAC9C,OAAO,EAAE,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC;qBAC1C;oBACH,CAAC,CAAC,EAAE,CAAC;aACR;YACD,cAAc,EAAE,IAAI;YACpB,aAAa,EAAE,IAAI;YACnB,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,8BAA8B,EAAE,KAAK,EAAE,CAAC;YACvE,IAAI;YACJ,KAAK;SACN,CAAC,CAAC;IACL,CAAC,CACF,CAAC;IAEF,4CAA4C;AAC9C,CAAC","sourcesContent":["import { Logger } from \"winston\";\nimport * as Sentry from \"@sentry/node\";\n\nimport { robustFetch } from \"../../lib/fetch\";\nimport { MockState } from \"../../lib/mock\";\nimport { fireEngineURL } from \"./scrape\";\n\nexport async function fireEngineDelete(\n  logger: Logger,\n  jobId: string,\n  mock: MockState | null,\n  abort?: AbortSignal,\n) {\n  await Sentry.startSpan(\n    {\n      name: \"fire-engine: Delete scrape\",\n      attributes: {\n        jobId,\n      },\n    },\n    async (span) => {\n      await robustFetch({\n        url: `${fireEngineURL}/scrape/${jobId}`,\n        method: \"DELETE\",\n        headers: {\n          ...(Sentry.isInitialized()\n            ? {\n                \"sentry-trace\": Sentry.spanToTraceHeader(span),\n                baggage: Sentry.spanToBaggageHeader(span),\n              }\n            : {}),\n        },\n        ignoreResponse: true,\n        ignoreFailure: true,\n        logger: logger.child({ method: \"fireEngineDelete/robustFetch\", jobId }),\n        mock,\n        abort,\n      });\n    },\n  );\n\n  // We do not care whether this fails or not.\n}\n"]}